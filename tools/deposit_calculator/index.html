<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    <title>Deposit Calculator</title>
    <link rel="shortcut icon" href='favicon.ico' />
    <link rel="stylesheet" href="http://twitter.github.com/bootstrap/assets/css/bootstrap-1.1.1.min.css">
    <script src="https://www.google.com/jsapi?key=ABQIAAAAkazS2OpN70z3z06RUSEeKhQQNLuGGkiHDgfdLxYLNyOCq-j0fRRT_kktDmQ646dAONr3J0XeJIZbdQ" type="text/javascript"></script>
    <script src='js/modernizr.min.js'></script>
    <script type="text/javascript">
      google.load('jquery', '1.6.3');
      google.load("visualization", "1", {packages:["corechart"]});

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17497138-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <script type="text/javascript">
      function round(num) {
        return Math.round(num * 100) / 100;
      }

      $(function() {
        if (!Modernizr.input.autofocus)
          $('#principal_amount').focus();

        $('#calc_form').submit(function(){
          var principal_amount = parseFloat($('#principal_amount').attr('value'));
          var rate = parseFloat($('#rate').attr('value'));
          var months = parseInt($('#months').attr('value'));
          var capitalisation = $('#capitalisation').attr('checked');
          var total_interest = 0;
          var chart_data = new google.visualization.DataTable();

          chart_data.addColumn('string', 'Month');
          chart_data.addColumn('number', 'Total');

          for (var i = 1; i <= months; i++) {
            if (capitalisation) {
              month_interest = (principal_amount + total_interest) * rate / 12 / 100;
              total_interest += month_interest;
              chart_data.addRow([i.toString(), round(principal_amount + total_interest)]);
            }
            else {
              month_interest = principal_amount * rate / 12 / 100;
              total_interest += month_interest;
              chart_data.addRow([i.toString(), round(principal_amount + total_interest)]);
            }
          }

          $('#total_interest').text(round(total_interest));
          $('#maturity_value').text(round(total_interest + principal_amount));

          var chart = new google.visualization.LineChart(document.getElementById('chart'));
          chart.draw(chart_data, {width: 400, height: 240, title: 'Maturity value per month', hAxis: {title: 'Month'}});

          $('#results').show();

          return false;
        })
      })
    </script>
  </head>
  <body>
    <div class='container'>
      <h1>Deposit calculator</h1>
      <noscript><div class='alert-message error'>You must have Javascript enabled to use .</div></noscript>
      <form class='form-stacked' id='calc_form'>
        <fieldset>
          <div class='clearfix'>
            <label for='principal_amount'>Principal amount</label>
            <input type='text' required autofocus autocomplete='off' name='principal_amount' id='principal_amount'>
          </div>

          <div class='clearfix'>
            <label for='rate'>Interest rate</label>
            <input type='text' required autocomplete='off' name='rate' id='rate'> %
          </div>

          <div class='clearfix'>
            <label for='months'>Months</label>
            <input type='text' required autocomplete='off' name='months' id='months'>
          </div>

          <div class='clearfix'>
            <label for='capitalisation'>
              <input type='checkbox' name='capitalisation' id='capitalisation'> <span>Capitalisation</span>
            </label>
          </div>

          <br>
          <div class='clearfix'>
            <button class='btn primary' type='submit'>Calculate</button>
          </div>
        </fieldset>
      </form>

      <div id='results' class='alert-message block-message success' style='display:none;'>
        <b>Total interest:</b> <span id='total_interest'></span><br>
        <b>Maturity value:</b> <span id='maturity_value'></span><br>
        <div id='chart'></div>
      </div>
    </div>
  </body>
</html>
